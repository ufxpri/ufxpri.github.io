EBS

Elastic block store
하나의 인스턴스에만 연결 가능하고 하나의 AZ에 국한된다.

30GB 무료

뮬리적 볼륨이 아니다
그래서 연결되려면 네트워크를 거쳐야 하며 네트워크의 겅능에 국한된다.

스냅샷을 이용하면 여러 AZ에서 복제해 사용 할 수 있다.

GB 와 IOPS 를 계산한다.


연결되지 않은 상태로 둘 수도 있다.

"종료시 삭제" - 인스턴스를 삭제하면 연결된 EBS도 같이 삭제된다.
root 볼륨은 기본적으로 활성화 되어 있다.
다른 볼륨은 기본적으로 비활성화 되어 있다.


EBS 스냅샷

스냅샷이란 특정 시간의 백업이다. 다른 가용영역과 리전으로 복사할 수 있다.

EBS 아카이브
스냅샷을 "아카이프 티어" 로 이동하면 75% 저렴한 가격으로 보관할 수 있다.
복원이 24에서 72시간정도 걸린다.

EBS Snapshots 의 휴지통
영구삭제 대신에 휴지통에 넣을 수 있다.
1일에서 1년으로 설정하여 사용한다.

Fast Snapshot Restore (FSR)
초반에 초기화 할 시간도 없이 바로 사용할 수 있는 스포리지 이다. 가격이 매우 비싸다.



AMI 는 Amazon Machine Image 의 약자
인스턴스의 이미지를 의미한다.

나만의 AMI 를 만들 수 있다.

특정 리전에만 사용되도록 만들어졌다.

public AMI - 공식, 가장 인기있음
custom AMI - 직접 만들어서 실행할 수 있다.
Marketplace AMI - 다른사람이 많은 AMI 를 구매할 수 있다.

AMI 를 만드는 과정은 심플하다.
1. ams 에서 기본 제공하는 AMI 를 사용하여 부팅한다.
2. AMI 생성이 완료되면 image & template 에서 "이미지 생성" 을 선택한다.
3. 새 인스턴스 만들기를 선택한 후 생성했던 custom AMI 를 사용하여 인스턴스를 만든다.

새로 생성된 AMI 는 기존 설정을 다 가지고 있기 때문에 초기 설정이 필요없다. 이를 통해 인스턴스르 ㄹ빠르게 업로드 할 수 있다.

EC2 Instance Store
EBS 는 네트워크 드라이브지만 한정된 성능을 가진다.
높은 성능을 요구한다면 EC2 Instance Store 를 사용해야 한다.

- 높은 I/O 성능
- 멈추면 사라짐
- 버퍼/ 캐시/ 임시 데이터
- 하드웨어 실패시 잃어버림

EC2  차트에 따르면 시리즈에 따라 IOPS 가 정해져 있다.

EBS Volume Type
7개의 종류가 있다.

gp2/gp3 - 일반 용도의 SSD 볼륨. 성능과 비용 균일함
io1/io2 - 높은 성능의 SSD 볼륨. 높은 입출력 성능을 가지고 있음
st1 - 낮은 비용의 HDD 볼륨. 잦은 엑세스와 성능에 적합
sc1 - 최고로 낮은 비용의 HDD 볼륨. 덜 잦은 엑세스에 적합

EBS 를 결정하는 많은 요소가 있는데
사이즈/성능/IOPS 가 된다.
오직 gp2/gp3, io1/io2 만 부트 볼륨으로 사용 가능하다.

gpx
부트볼륨, 가상 데스크톱, 개발 및 테스트
1GB ~ 16TB
gp3 - 3,000-16,000 IOPS, 125-1000 MiB/s
gp2 - 볼륨과 IOPs 가 연계됨. 3,000-16,000 IOPS, GB당 3IOPS, 5,334 GB 에 16,000IOPS 가 됨

Provisioned IOPS (PIOPS) SSD
- IOPS 가 핵심인 용도에 사용됨
- 16,000 IOPS 초과 성능을 지원함
- 데이타데이스 용도에 최적화됨
io1/io2 (4 GiB - 16TiB)
Nitro EC2 - 64,000 IOPS
EC2 - 32,000 IOPS
io2 가 더욱 경제적
io2 Block Express (4GiB- 64TiB) - 서브 밀리세컨드, 256,000IOPS
EBS 다중 연결을 지원함

HDD
부트볼륨이 될 수 없음
125MiB - 16TiB
thoughput optimized hdd (st1)


다중 연결 기능
같은 AZ 안의 여러 인스턴스에 EBS 볼륨을 연결 가능 (io1/io2 만 가능)
사용 용도는 클러스터링, 연속 쓰기 지원
16개 까지만 동시에 연결가능
클러스터 인식 파일시스템을 사용해야함 (sfx ex4)

EBS 암호화
스냅샷 데이터 이동 생성까지 모두 암호화됨
암호화에는 지연시간이 거의 없음
KMS(AES-256) 로 부터 암호화 키를 가져온다.
이미 있는 인스턴스 EBS 암호화!
1. EBS 볼륨의 스냅샷을 만든다.
2. EBS 스냅샷을 암호화 한다 (복사본을)
3. 스냅샷으로 새 EBS 볼륨을 만든다. (암호화 되어있음)
4. 원본 인스턴스에 다시 연결한다.

EFS Elastic File System
네트워크 파일 시스템이다.
ㅇ러 인스턴스에서 사용할 수 있고 여러 AZ 에서 사용할 수 있다.
가격은 EBS의 3배정도...
유저당 비용을 받는다.
웹서버, 데이터공유, 워드프레스, 콘텐츠관리
NFSv4.1 프로토콜
보안그룹에 있는 유저만 사용가능
리눅스 계열의 AMI 만 지원함
이 역시 KMS 를 통해 암호화됨

--중요--
EFS 스케일
- 1000명의 유저 동시 사용 가능, 10GB+/s 의 성능
- 자동으로 페타규모의 nfs 까지 확장됨

퍼포먼스 모드
- 일반 : 적은 레이턴시
- I/O 최적 : 높은 레이턴시, 처리성능, 높은 병렬 (빅데이터, 미디어 프로세싱)

처리량 모드
- bursting (1TB당 50MiB/s + 100MiB/s 까지 성장)
- provisioned : 스토리지 사이즈와 관계없이 1GiB/s 1TBstorage 설정가능)

스토리지 클래스

스토리지 티어 - Lifecycle Policy 를 사용해 제어 가능
- standard : 자주 접근하는 파일들
- infrequent access (EFS-IA) : 잘 사용하지 않은 파일을 적은 비용으로 보관

가용성과 내구성
- standard : Multi-AZ 상업용으로 좋음
- One Zone : One-AZ 개발용으로 좋음. 기본적으로 백업이 활성화됨. IA 사용가능 (EFS One Zone-IA) (90% 까지 비용 절감 가능)

EBS vs EFS
EBS
오직 하나의 인스턴스에만 연결가능
